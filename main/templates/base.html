<!DOCTYPE html>
<head>

    <script src="{{ url_for('static', filename='jquery-3.6.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='template.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='loading.css') }}">

</head>
<body>

    <h3 id = "title">Scraped Feeds</h3>
    <h3><div id = "checkbox">Select an element you want to delete. click "check all" to select everything.</div></h3>

    <form method="POST">
        <div id="loading"></div>
        <input type="submit" name = "scrape" value = "scrape" onclick="scrapeloading();"><br>

        <label id = "select" onclick = "selectbox();">select</label><br>

        <div id = "checkbox">
            <button type="submit" name = "delete">delete</button>
            <label onclick = "checkall();">check all</label>
        </div>

        <br>
        <label id = "error">Error : {{msg}}</label>
        <br>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <br>

        <button><a href={{ url_for("insert.insert") }}>addsite</a></button>
        <br>

        <div class="contents left">
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th onclick = "tablesort(1);">Site<br><label id = sorted_1></label></bt></th>
                        <th onclick = "tablesort(2);">Type<br><label id = sorted_2></label></th>
                        <th onclick = "tablesort(3);">Scraped At<br><label id = sorted_3></label></th>
                        <th>Title</th>
                        <th>Author</th>
                    </tr>
                </thead>
                <tbody>
                        {% for i in sitefeed.items %}
                        <tr>
                            <td><input type="checkbox" name = {{ i.link }}></td>
                            <td>{{ i.sitename }}</td>
                            <td>{{ i.sitetype }}</td>
                            <td>{{ i.postdate }}</td>
                            <td><a href = {{ i.link }} target = "preview">{{ i.title }}</a></td>
                            <td>{{ i.author }}</td>
                        </tr>
                        {% endfor %}
                </tbody>
            </table>
            {% if sitefeed.has_prev %}
            <a href="{{ url_for('index', page=sitefeed.prev_num) }}">&lt;&lt; Newer posts</a>
            {% else %}
            &lt;&lt; Newer posts

            {% endif %}
    
            |
    
            {% if sitefeed.has_next %}
            <a href="{{ url_for('index', page=sitefeed.next_num) }}">Older posts &gt;&gt;</a>
            {% else %}
            Older posts &gt;&gt;

            {% endif %}
        </div>

        <div class="contents right">
            <iframe src="default.asp" name = "preview" width = "500px" height="1000px"></iframe>
        </div>
    </form>
</body>